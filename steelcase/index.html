<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="renderer" content="webkit">
  <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta name="author" content="TylerChao">
  <meta name="keywords" content="keywords">
  <meta name="description" content="description">
  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
  <link rel="apple-touch-icon" href="/favicon.png">
  <link rel="stylesheet" href="assets/css/mobile.css">
  <link rel="stylesheet" href="assets/plugins/swiper.css">
  <link rel="stylesheet" href="assets/plugins/pageSwitch.css">
  <link rel="stylesheet" href="assets/css/main.css">
  <title>Steelcase</title>
  <style>
    html, body {
      position: relative;
      height: 100%;
    }
  </style>
</head>

<body style="visibility: hidden;">
  <ul id="nav" class="bar-tabs nav">
    <li class="controller"><a href="javascript:void(0);" class="swiper-btn-next">Steelcase<br> Series 1</a></li>
    <li class="controller"><a href="get-in-touch.html">联络我们</a></li>
    <li class="controller"><a href="what-we-do.html">关于我们</a></li>
  </ul>
  <main id="fullpage" class="swiper-container">
    <div class="swiper-wrapper">
      <!-- One -->
      <div class="swiper-slide">
        <div id="slider" class="slide-container">
          <div class="swiper-wrapper">
            <!-- One -->
            <div class="swiper-slide">
              <span class="text text-1">
                快乐是标配<br>头枕是选配
              </span>
              <img src="assets/img/slide1.jpg" alt="">
            </div>
            <!-- Two -->
            <div class="swiper-slide">
              <span class="text text-2">
                连坐都有坐相
              </span>
              <img src="assets/img/slide2.jpg" alt="">
            </div>
            <!-- Three -->
            <div class="swiper-slide">
              <span class="text text-3">
                令人望其项背<br>的身心科技 
              </span>
              <img src="assets/img/slide3.jpg" alt="">
            </div>
            <!-- Four -->
            <div class="swiper-slide">
              <span class="text text-4">
                工作时也需要<br>是衣架子
              </span>
              <img src="assets/img/slide4.jpg" alt="">
            </div>
            <!-- Five -->
            <div class="swiper-slide">
              <span class="text text-5">
                挑一种颜色，<br>连黑色也足够出色
                <span class="text bottom">
                  <h1><span><img src="assets/img/logo-white.png" alt="steelcase"></span> Series 1</h1>
                  <p>每个人，每一处，恰到好处</p>
                </span>
              </span>
              <img src="assets/img/slide5.jpg" alt="">
            </div>
          </div>
          <div class="slide-nav">
            <a rel="prev" class="icon-arrow-back swiper-prev"></a>
            <a rel="next" class="icon-arrow-forward swiper-next"></a>
          </div>
        </div>
        <div class="placeholder"></div>
      </div>
      <!-- Two -->
      <div data-hash="next" class="swiper-slide">
        <div class="placeholder"></div>
        <div id="subSlider" class="swiper-container autoheight">
          <div class="swiper-wrapper">
            <!-- One -->
            <div class="swiper-slide">
              <div class="intro">Series 1 提供更多个性化选择，完美呈现您独特的品牌风格及公司文化，亦能让每个使用者都能找到适合自己的配搭。每个人，每一处，恰到好处。</div>
            </div>
            <!-- Two -->
            <div class="swiper-slide">
              <div id="chair" class="chair-swiper">
                <header class="tab-header">
                  <h1>选你所想</h1>
                  <ul class="tab">
                    <li class="active"><a>颜色</a></li>
                    <li><a>纹理</a></li>
                    <li><a>选配功能</a></li>
                  </ul>
                </header>
                <div id="color1" class="color purple show">
                  <section>
                    <div class="chair show angle1"></div>
                    <div class="chair angle2"></div>
                    <div class="chair angle3"></div>
                    <div class="chair angle4"></div>
                    <div class="chair angle5"></div>
                    <div class="chair angle6"></div>
                    <div class="chair angle7"></div>
                    <div class="chair angle8"></div>
                  </section>
                </div>
                <div id="color2" class="color orange">
                  <section>
                    <div class="chair show angle1"></div>
                    <div class="chair angle2"></div>
                    <div class="chair angle3"></div>
                    <div class="chair angle4"></div>
                    <div class="chair angle5"></div>
                    <div class="chair angle6"></div>
                    <div class="chair angle7"></div>
                    <div class="chair angle8"></div>
                  </section>
                </div>
                <div id="color3" class="color red">
                  <section>
                    <div class="chair show angle1"></div>
                    <div class="chair angle2"></div>
                    <div class="chair angle3"></div>
                    <div class="chair angle4"></div>
                    <div class="chair angle5"></div>
                    <div class="chair angle6"></div>
                    <div class="chair angle7"></div>
                    <div class="chair angle8"></div>
                  </section>
                </div>
                <div id="color4" class="color teal">
                  <section>
                    <div class="chair show angle1"></div>
                    <div class="chair angle2"></div>
                    <div class="chair angle3"></div>
                    <div class="chair angle4"></div>
                    <div class="chair angle5"></div>
                    <div class="chair angle6"></div>
                    <div class="chair angle7"></div>
                    <div class="chair angle8"></div>
                  </section>
                </div>
                <div id="color5" class="color yellow">
                  <section>
                    <div class="chair show angle1"></div>
                    <div class="chair angle2"></div>
                    <div class="chair angle3"></div>
                    <div class="chair angle4"></div>
                    <div class="chair angle5"></div>
                    <div class="chair angle6"></div>
                    <div class="chair angle7"></div>
                    <div class="chair angle8"></div>
                  </section>
                </div>
                <div id="color6" class="color green">
                  <section>
                    <div class="chair show angle1"></div>
                    <div class="chair angle2"></div>
                    <div class="chair angle3"></div>
                    <div class="chair angle4"></div>
                    <div class="chair angle5"></div>
                    <div class="chair angle6"></div>
                    <div class="chair angle7"></div>
                    <div class="chair angle8"></div>
                  </section>
                </div>
                <button type="button" data-direction="prev" class="icon-arrow-back arrow" disabled></button>
                <button type="button" data-direction="next" class="icon-arrow-forward arrow"></button>
                <input id="angleSlider" hidden class="angleSlider" type="range" min="1" max="8" step="1" value="1">
                <div id="shadow" class="shadow"></div>
                <div class="switcher">
                  <div class="btn-group grid-8">
                    <button type="button" class="active">白色</button>
                    <button type="button">黑色</button>
                  </div>
                  <div class="switch-group grid-4">
                    <label for="radioSwitch">金属色</label>
                    <div class="switch round">
                      <input id="radioSwitch" type="checkbox">
                      <label for="radioSwitch"></label>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- Three -->
            <div class="swiper-slide">
              <div class="video">
                <div class="cover">
                  <h1>&nbsp;&nbsp;每个人，
                    <br>&nbsp;每一处，
                    <br>全力以赴。
                  </h1>
                  <i class="icon-play"></i>
                  <p><img src="assets/img/logo-white.png" alt="steelcase"> Series 1<br>
                    舒适随心</p>
                </div>
              </div>
            </div>
            <div class="swiper-slide">
              <div class="dimensions">
                <h1>直观调整，轻松 <br>找到合适角度。</h1>
                <div class="chair"><img src="assets/img/chair.png" alt=""></div>
                <div class="description">
                  <section class="param1">
                    <p>综合LiveBack® 技术，给你想要的新视角。</p>
                  </section>
                  <section class="param2">
                    <p>自主支撑设计， 放松身体专注<br>任务。</p>
                  </section>
                  <section class="param3">
                    <p>重量激活仰背功能，放松每块紧绷肌肉。</p>
                  </section>
                  <section class="param4">
                    <p>4D旋转扶手， 撑起的你工作<br>激情。</p>
                  </section>
                </div>
              </div>
              <a href="get-in-touch.html" class="tile">
                <p>联络我们</p>
                <i class="icon-arrow-right"></i>
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Add Scrollbar -->
    <div class="swiper-scrollbar"></div>
  </main>
  <script src="assets/js/libs.min.js"></script>
  <script src="assets/js/mobile.js"></script>
  <script src="assets/js/main.js"></script>
  <script src="assets/plugins/swiper.js"></script>
  <script src="assets/plugins/pageSwitch.js"></script>
  <script>
  setTimeout(function() {
    document.body.style.visibility = '';
    if(location.hash === '#next') {
      var y = 70 - window.innerHeight;
      $('#nav .swiper-btn-next').parent()
        .addClass('active')
        .parent()
        .css({
          '-webkit-transition': 'none',
          'transition': 'none',
          '-webkit-transform': 'translate(0, ' + y + 'px)',
          'transform': 'translate(0, ' + y + 'px)',
        });
      swiper.detachEvents();
    }
  }, 0);

  var swiper = new Swiper('#fullpage', {
    direction: 'vertical',
    effect: 'slide',
    slidesPerView: 'auto',
    initialSlide: 0,
    nextButton: '.swiper-btn-next',
    hashnav: true,
    hashnavWatchState: true,
    history: false,
    scrollbar: '.swiper-scrollbar',
  });

  var subs = new Swiper('#subSlider', {
    direction: 'vertical',
    effect: 'slide',
    autoHeight: true,
    nested: true,
    slidesPerView: 'auto',
    observer: true,
    // freeMode: true,
    freeModeMomentumBounce: false,
  });

  var nav = $('#nav');

  var startY = 0;
  var currentY = 0;
  // nav
  //   .clone(true)
  //   .attr('id', 'nav1')
  //   .hide()
  //   .css('position', 'relative')
  //   .appendTo('.placeholder:eq(1)');

  swiper.slides.eq(0)
    .on('touchstart', function(e) {
      startY = currentY = e.originalEvent.targetTouches[0].pageY;
    })
    .on('touchmove', function(e) {
      currentY = e.originalEvent.targetTouches[0].pageY;

      if (startY != currentY) {
        return false;
      }
    });

  $('#nav .swiper-btn-next').on('click', function(e) {
    // e.preventDefault();
    // if (swiper.activeIndex !== 0) return;
    // swiper.slideNext();
    var y = 70 - window.innerHeight;
    $(this).parent()
      .addClass('active')
      .parent()
      .css({
        'transform': 'translate(0, ' + y + 'px)',
        '-webkit-transform': 'translate(0, ' + y + 'px)'
      });
    swiper.detachEvents();
    // $('#nav1 .swiper-btn-next').parent().addClass('active');
  });

  // swiper
    // .on('touchStart', function(e) {
    //   if (swiper.activeIndex === 1) {
    //     return false;
    //   }
    // })
    // .on('sliderMove', function(e) {
    //   if (swiper.touches.startY < swiper.touches.currentY) {
    //     if (swiper.activeIndex === 1) {
    //       nav
    //         .hide()
    //         .css({
    //           'transform': '',
    //           '-webkit-transform': ''
    //         });
    //       // $('#nav1').show();
    //     }
    //   }
    // });
    // .on('transitionEnd', function(e) {
    //   if (swiper.activeIndex === 0) {
    //     $('#nav1')
    //       .css({
    //         'transform': 'translate(0, -70px)',
    //         'webkitTransform': 'translate(0, -70px)',
    //         'transition-duration': '.1s',
    //       })
    //       .on('transitionend webkitTransitonEnd', function(e) {
    //         $(this)
    //           .hide()
    //           .css({
    //             'transform': '',
    //             'transition-duration': '',
    //           });
    //         nav.show();
    //       });
    //   }
    // });

  subs
    .on('touchStart', function(e) {
      subs.snapGrid[4] = subs.snapGrid[3] + subs.slides[3].offsetHeight - window.innerHeight + 70;
      // if (subs.activeIndex === 1) {
      //   subs.container.find('.swiper-slide').eq(0).show();
      //   subs.container.find('.swiper-wrapper').css({
      //     'transform': 'translate(0, -195px)'
      //   });
      // }

      // if(subs.activeIndex === 3) {
      //   subs.params.allowSwipeToNext = false;
      // // } else if(subs.activeIndex === 0) {
      // //   subs.params.allowSwipeToPrev = false;
      // } else {
      //   subs.params.allowSwipeToNext = true;
      //   // subs.params.allowSwipeToPrev = true;
      // }
    })
    .on('touchMove', function(e) {
      // console.log(subs.isEnd);
      // if (subs.isEnd) {
      //   subs.detachEvents();
      // }

      if (subs.activeIndex === 3 && (subs.swipeDirection === 'next' || (subs.swipeDirection === 'prev' && subs.translate < -1238))) {
        subs.params.freeMode = true;
      }
      else {
        subs.params.freeMode = false;
      }

      // if(subs.translate <= -1386) {
      //   subs.setWrapperTransition(300);
        // subs.setWrapperTranslate(-1386);
        // subs.wrapper.css({
        //   'transform': 'translate3d(0, -1386px, 0);',
        //   '-webkit-transform': 'translate3d(0, -1386px, 0);',
        // });
        // console.log(wrapper.css('transform'));
        // subs.params.touchMoveStopPropagation = true;
      // }
    })
    .on('touchEnd', function(e) {
      if (subs.translate > -1238) {
        subs.params.freeMode = false;
      }

      // if (subs.translate <= -1386) {
      //   subs.setWrapperTransition(300);
      //   subs.setWrapperTranslate(-1386);
      // }
    })
    .on('transitionEnd', function(e) {
      if (subs.translate > -1238) {
        var arr = [];
        for(var i = 0; i < subs.slidesGrid.length; i++) {
          arr.push(Math.abs(subs.translate + subs.slidesGrid[i]));
        }
        subs.slideTo(smallest(arr));
        subs.params.freeMode = false;
      }

      // if (subs.translate <= -1386) {
      //   subs.setWrapperTransition(0);
      //   subs.setWrapperTranslate(-1386);
      // }
  });

  subs.container
    .on('touchmove', function(e) {
      // var translateY = subs.wrapper.css('transform').match(/^matrix\(([-\d.]+,?\s?)+\)$/)[1];
      if (subs.translate <= -1386) {
      }
    })


  var slider = new pageSwitch('#slider .swiper-wrapper', {
      duration: 1000,
      start: 0,
      direction: 0,
      loop: true,
      ease: 'ease',
      transition: 'scrollCoverX',
      mouse: false,
      mousewheel: false,
      arrowkey: false
    }),
    navs = $('#slider .slide-nav a'),
    text = $('#slider .swiper-slide .text');

  navs.on('click', function(e) {
    slider.slide(slider.current + 1 * (this.rel === 'next' ? 1 : -1));
  });
  text[0].classList.add('active');
  slider.on('before', function(m, n) {
    text[m].classList.remove('active');
  }).on('after', function(m, n) {
    text[m].classList.add('active');
  });


  function smallest(a) {
    var lowest = 0;
    for (var i = 1; i < a.length; i++) {
      if (a[i] < a[lowest]) lowest = i;
    }
    return lowest;
  }

</script>
</body>

</html>
